!include MUI2.nsh

!define APP_NAME "AI Development Workstation"
!define COMPANY_NAME "AI Dev Workstation"
!define VERSION "1.0.0.0"

Name "${APP_NAME}"
OutFile "..\release\${APP_NAME}-Setup-${VERSION}.exe"
InstallDir "$PROGRAMFILES\${COMPANY_NAME}\${APP_NAME}"
InstallDirRegKey HKLM "Software\${COMPANY_NAME}\${APP_NAME}" "Install_Dir"

!insertmacro MUI_PAGE_WELCOME
!insertmacro MUI_PAGE_DIRECTORY
!insertmacro MUI_PAGE_INSTFILES
!insertmacro MUI_PAGE_FINISH

!insertmacro MUI_UNPAGE_CONFIRM
!insertmacro MUI_UNPAGE_INSTFILES

!insertmacro MUI_LANGUAGE "English"

Section "Application"
  SetOutPath "$INSTDIR"
  
  File /r "..\dist\*"
  File /r "..\node_modules\*"
  
  WriteRegStr HKLM "Software\${COMPANY_NAME}\${APP_NAME}" "Install_Dir" "$INSTDIR"
  WriteUninstaller "$INSTDIR\Uninstall.exe"
  
  CreateShortcut "$SMPROGRAMS\${APP_NAME}.lnk" "$INSTDIR\${APP_NAME}.exe"
  CreateShortcut "$DESKTOP\${APP_NAME}.lnk" "$INSTDIR\${APP_NAME}.exe"
SectionEnd

Section "Uninstall"
  DeleteRegKey HKLM "Software\${COMPANY_NAME}\${APP_NAME}"
  
  RMDir /r "$INSTDIR"
  Delete "$SMPROGRAMS\${APP_NAME}.lnk"
  Delete "$DESKTOP\${APP_NAME}.lnk"
SectionEnd